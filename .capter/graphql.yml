name: graphql-inline
url: https://fake-api.capter.io/api/graphql
steps:
  - name: fetch all posts
    id: posts
    graphql:
      query: |
        query posts {
          posts {
            id
            title
            content
          }
        }
    assertions:
      - !assert status to_equal 200
      - !assert headers.content-type to_contain application/json
      - !assert body.data.posts to_be_array

  - name: fetch one post
    id: post
    graphql:
      query: |
        query post($id: Int!) {
          post(id: $id) {
            id
            title
            content
          }
        }
      variables:
        id: ${{ posts.response.body.data.posts.1.id }}
    assertions:
      - !assert status to_equal 200
      - !assert body.data.post.id to_equal 1
